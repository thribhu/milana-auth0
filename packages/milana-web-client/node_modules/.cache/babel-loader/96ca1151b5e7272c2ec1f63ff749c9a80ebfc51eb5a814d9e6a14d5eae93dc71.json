{"ast":null,"code":"var _jsxFileName = \"/home/dell/dev/upwork/casdoor-auth/milana-casdoor-auth/packages/milana-web-client/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport SDK from 'casdoor-js-sdk';\nimport { config } from './Setting';\nimport '@fontsource/roboto/300.css';\nimport '@fontsource/roboto/400.css';\nimport '@fontsource/roboto/500.css';\nimport '@fontsource/roboto/700.css';\n//utils\nimport axiosInstance from './api/api.config';\n//styles\nimport GlobalStyle from './styles/globalStyle';\n//components and pages\nimport Sidebar from './Pages/Dashboard/Sidebar';\nimport Navbar from './Components/Navbar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [username, setUsername] = useState('');\n  const [displayName, setDisplayName] = useState('');\n  const [userAvatar, setUserAvatar] = useState('');\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [sdk] = useState(new SDK(config));\n  const [tokenReceived, setTokenReceived] = useState(false);\n  useEffect(() => {\n    if (window.location.href.indexOf('code') !== -1) {\n      if (!sessionStorage.getItem('token')) {\n        sdk.signin('http://localhost:8080').then(res => {\n          sessionStorage.setItem('token', res.token);\n          setTokenReceived(true);\n        });\n      }\n    }\n  }, [sdk]);\n  useEffect(() => {\n    if (sessionStorage.getItem('token')) {\n      getInfo().then(res => setInfo(res));\n      async function getInfo() {\n        try {\n          const response = await axiosInstance.get('getUsersInfo');\n          return response.data;\n        } catch (err) {\n          throw err;\n        }\n      }\n      function setInfo(userinfo) {\n        setUsername(userinfo.name);\n        setDisplayName(userinfo.displayName);\n        setUserAvatar(userinfo.avatar);\n        setIsLoggedIn(true);\n      }\n    }\n  }, [tokenReceived]);\n\n  //!Note:for ease we are setting the default signin method\n  function gotoSignInPage() {\n    // document.getElementById('loginMethod').value === 'signin'\n    //   ? (window.location.href = sdk.getSigninUrl())\n    //   : sdk.popupSignin('http://localhost:8080');\n    window.location.href = sdk.getSigninUrl();\n  }\n  function signOut() {\n    sessionStorage.removeItem('token');\n    setTokenReceived(false);\n    window.location.href = 'http://localhost:9000';\n  }\n  return /*#__PURE__*/_jsxDEV(React.StrictMode, {\n    children: [/*#__PURE__*/_jsxDEV(GlobalStyle, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), isLoggedIn ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Sidebar, {\n        name: displayName,\n        avatar: userAvatar,\n        signout: signOut\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this)\n    }, void 0, false) : /*#__PURE__*/_jsxDEV(Navbar, {\n      signin: gotoSignInPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"t4iZDUObXQfNuZ7MTEAv5FxFUgc=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","SDK","config","axiosInstance","GlobalStyle","Sidebar","Navbar","App","username","setUsername","displayName","setDisplayName","userAvatar","setUserAvatar","isLoggedIn","setIsLoggedIn","sdk","tokenReceived","setTokenReceived","window","location","href","indexOf","sessionStorage","getItem","signin","then","res","setItem","token","getInfo","setInfo","response","get","data","err","userinfo","name","avatar","gotoSignInPage","getSigninUrl","signOut","removeItem"],"sources":["/home/dell/dev/upwork/casdoor-auth/milana-casdoor-auth/packages/milana-web-client/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport SDK from 'casdoor-js-sdk';\nimport { config } from './Setting';\nimport '@fontsource/roboto/300.css';\nimport '@fontsource/roboto/400.css';\nimport '@fontsource/roboto/500.css';\nimport '@fontsource/roboto/700.css';\n//utils\nimport axiosInstance from './api/api.config';\n//styles\nimport GlobalStyle from './styles/globalStyle';\n//components and pages\nimport Sidebar from './Pages/Dashboard/Sidebar';\nimport Navbar from './Components/Navbar';\n\nfunction App() {\n  const [username, setUsername] = useState('');\n  const [displayName, setDisplayName] = useState('');\n  const [userAvatar, setUserAvatar] = useState('');\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [sdk] = useState(new SDK(config));\n  const [tokenReceived, setTokenReceived] = useState(false);\n\n  useEffect(() => {\n    if (window.location.href.indexOf('code') !== -1) {\n      if (!sessionStorage.getItem('token')) {\n        sdk.signin('http://localhost:8080').then((res) => {\n          sessionStorage.setItem('token', res.token);\n          setTokenReceived(true);\n        });\n      }\n    }\n  }, [sdk]);\n\n  useEffect(() => {\n    if (sessionStorage.getItem('token')) {\n      getInfo().then((res) => setInfo(res));\n\n      async function getInfo() {\n        try {\n          const response = await axiosInstance.get('getUsersInfo');\n          return response.data;\n        } catch (err) {\n          throw err;\n        }\n      }\n      function setInfo(userinfo) {\n        setUsername(userinfo.name);\n        setDisplayName(userinfo.displayName);\n        setUserAvatar(userinfo.avatar);\n        setIsLoggedIn(true);\n      }\n    }\n  }, [tokenReceived]);\n\n  //!Note:for ease we are setting the default signin method\n  function gotoSignInPage() {\n    // document.getElementById('loginMethod').value === 'signin'\n    //   ? (window.location.href = sdk.getSigninUrl())\n    //   : sdk.popupSignin('http://localhost:8080');\n    window.location.href = sdk.getSigninUrl();\n  }\n\n  function signOut() {\n    sessionStorage.removeItem('token');\n    setTokenReceived(false);\n    window.location.href = 'http://localhost:9000';\n  }\n\n  return (\n    <React.StrictMode>\n      <GlobalStyle />\n      {isLoggedIn ? (\n        <>\n          <Sidebar name={displayName} avatar={userAvatar} signout={signOut} />\n        </>\n      ) : (\n        <Navbar signin={gotoSignInPage} />\n      )}\n    </React.StrictMode>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}